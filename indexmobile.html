<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <title>InfiCounter Mobile</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
      background: linear-gradient(135deg, #1a1a2e 0%, #16213e 25%, #0f3460 50%, #533a71 75%, #6b4c57 100%);
      color: #e8e8e8;
      min-height: 100vh;
      padding: 16px;
      position: relative;
      overflow-x: hidden;
      touch-action: manipulation;
    }

    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: radial-gradient(circle at 20% 50%, rgba(120, 119, 198, 0.1) 0%, transparent 50%),
                  radial-gradient(circle at 80% 20%, rgba(255, 119, 198, 0.1) 0%, transparent 50%),
                  radial-gradient(circle at 40% 80%, rgba(120, 219, 255, 0.1) 0%, transparent 50%);
      pointer-events: none;
      z-index: 0;
    }

    .container {
      max-width: 100%;
      margin: 0 auto;
      position: relative;
      z-index: 1;
    }

    .header {
      text-align: center;
      margin-bottom: 24px;
      padding-top: max(env(safe-area-inset-top), 20px);
    }

    .logo {
      font-size: 2.2em;
      font-weight: 300;
      margin-bottom: 8px;
      background: linear-gradient(135deg, #20b2aa 0%, #ff6b9d 50%, #c471ed 100%);
      -webkit-background-clip: text;
      background-clip: text;
      -webkit-text-fill-color: transparent;
      letter-spacing: -1px;
    }

    .logo span {
      font-size: 1.2em;
      font-weight: 200;
    }

    h1 {
      font-size: 1.3em;
      font-weight: 300;
      color: rgba(255, 255, 255, 0.9);
      letter-spacing: -0.3px;
      margin-bottom: 4px;
    }

    .stats {
      display: flex;
      justify-content: space-around;
      margin-bottom: 20px;
      gap: 12px;
    }

    .stat-item {
      background: rgba(26, 26, 46, 0.6);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 12px;
      padding: 12px;
      text-align: center;
      flex: 1;
    }

    .stat-label {
      font-size: 11px;
      color: rgba(255, 255, 255, 0.6);
      margin-bottom: 4px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .stat-value {
      font-size: 16px;
      font-weight: 600;
      color: #20b2aa;
    }

    #output {
      background: rgba(26, 26, 46, 0.8);
      backdrop-filter: blur(20px);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 16px;
      padding: 20px;
      height: 45vh;
      overflow-y: auto;
      font-family: 'SF Mono', 'Monaco', 'Cascadia Code', monospace;
      font-size: 14px;
      line-height: 1.5;
      margin-bottom: 24px;
      box-shadow: 
        0 8px 32px rgba(0, 0, 0, 0.3),
        inset 0 1px 0 rgba(255, 255, 255, 0.1);
      white-space: pre-wrap;
      color: #e8e8e8;
      position: relative;
      -webkit-overflow-scrolling: touch;
    }

    #output::-webkit-scrollbar {
      width: 4px;
    }

    #output::-webkit-scrollbar-track {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 2px;
    }

    #output::-webkit-scrollbar-thumb {
      background: linear-gradient(135deg, #20b2aa, #ff6b9d);
      border-radius: 2px;
    }

    .main-controls {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
      margin-bottom: 20px;
    }

    .secondary-controls {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 8px;
      margin-bottom: 20px;
    }

    .utility-controls {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 8px;
      margin-bottom: 24px;
    }

    button {
      background: rgba(26, 26, 46, 0.6);
      backdrop-filter: blur(10px);
      color: #e8e8e8;
      border: 1px solid rgba(255, 255, 255, 0.1);
      padding: 14px 16px;
      border-radius: 12px;
      font-size: 13px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative;
      overflow: hidden;
      font-family: inherit;
      min-height: 48px;
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      user-select: none;
      -webkit-user-select: none;
    }

    .main-controls button {
      padding: 18px 20px;
      font-size: 14px;
      font-weight: 600;
      min-height: 56px;
    }

    .primary-btn {
      background: rgba(32, 178, 170, 0.2) !important;
      border-color: rgba(32, 178, 170, 0.4) !important;
      color: #20b2aa !important;
    }

    button::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
      transition: left 0.3s;
    }

    button:active {
      transform: scale(0.98);
      background: rgba(32, 178, 170, 0.15);
      border-color: rgba(32, 178, 170, 0.3);
    }

    button:active::before {
      left: 100%;
    }

    .contact-form {
      background: rgba(26, 26, 46, 0.9);
      backdrop-filter: blur(20px);
      padding: 24px;
      border-radius: 16px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      box-shadow: 
        0 8px 32px rgba(0, 0, 0, 0.3),
        inset 0 1px 0 rgba(255, 255, 255, 0.1);
      margin-top: 20px;
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: calc(100% - 32px);
      max-width: 400px;
      z-index: 1000;
      max-height: 80vh;
      overflow-y: auto;
    }

    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.5);
      backdrop-filter: blur(4px);
      z-index: 999;
      display: none;
    }

    .contact-form h2 {
      margin-bottom: 20px;
      background: linear-gradient(135deg, #20b2aa 0%, #ff6b9d 100%);
      -webkit-background-clip: text;
      background-clip: text;
      -webkit-text-fill-color: transparent;
      font-weight: 300;
      font-size: 1.3em;
      text-align: center;
    }

    .contact-form label {
      display: block;
      margin-bottom: 6px;
      font-weight: 500;
      color: rgba(255, 255, 255, 0.8);
      font-size: 13px;
    }

    .contact-form input,
    .contact-form textarea {
      width: 100%;
      padding: 12px 14px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 10px;
      background: rgba(255, 255, 255, 0.05);
      backdrop-filter: blur(10px);
      color: #e8e8e8;
      margin-bottom: 16px;
      font-family: inherit;
      font-size: 14px;
      transition: all 0.3s ease;
      resize: vertical;
    }

    .contact-form input:focus,
    .contact-form textarea:focus {
      outline: none;
      border-color: #20b2aa;
      box-shadow: 0 0 20px rgba(32, 178, 170, 0.2);
      background: rgba(255, 255, 255, 0.08);
    }

    .contact-form input::placeholder,
    .contact-form textarea::placeholder {
      color: rgba(255, 255, 255, 0.5);
    }

    .form-buttons {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
      margin-top: 20px;
    }

    .cancel-btn {
      background: rgba(255, 107, 107, 0.1) !important;
      border-color: rgba(255, 107, 107, 0.3) !important;
    }

    .welcome-message {
      text-align: center;
      color: rgba(255, 255, 255, 0.6);
      font-size: 13px;
      line-height: 1.6;
      padding: 20px;
    }

    .notification {
      position: fixed;
      top: max(env(safe-area-inset-top), 20px);
      left: 16px;
      right: 16px;
      background: rgba(26, 26, 46, 0.95);
      backdrop-filter: blur(20px);
      color: #e8e8e8;
      padding: 16px;
      border-radius: 12px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      z-index: 1001;
      font-size: 14px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
      transform: translateY(-120px);
      transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      text-align: center;
    }

    .bottom-safe-area {
      height: max(env(safe-area-inset-bottom), 16px);
    }

    @keyframes pulse {
      0%, 100% { opacity: 0.6; }
      50% { opacity: 1; }
    }

    .running-indicator {
      display: inline-block;
      width: 6px;
      height: 6px;
      background: #20b2aa;
      border-radius: 50%;
      margin-left: 6px;
      animation: pulse 1.5s infinite;
    }

    .theme-selector {
      position: fixed;
      bottom: max(env(safe-area-inset-bottom), 20px);
      right: 20px;
      background: rgba(26, 26, 46, 0.8);
      backdrop-filter: blur(20px);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 50%;
      width: 56px;
      height: 56px;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 100;
      transition: all 0.3s ease;
    }

    .fab {
      position: fixed;
      bottom: calc(max(env(safe-area-inset-bottom), 20px) + 70px);
      right: 20px;
      background: linear-gradient(135deg, #20b2aa, #ff6b9d);
      border: none;
      border-radius: 50%;
      width: 56px;
      height: 56px;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 100;
      font-size: 20px;
      box-shadow: 0 8px 32px rgba(32, 178, 170, 0.3);
    }

    /* Animations d'entrée */
    @keyframes slideInUp {
      from {
        opacity: 0;
        transform: translateY(30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .container > * {
      animation: slideInUp 0.6s ease forwards;
    }

    .container > *:nth-child(2) { animation-delay: 0.1s; }
    .container > *:nth-child(3) { animation-delay: 0.2s; }
    .container > *:nth-child(4) { animation-delay: 0.3s; }
    .container > *:nth-child(5) { animation-delay: 0.4s; }
  </style>
</head>
<body>
  <div class="modal-overlay" id="modalOverlay" onclick="closeModal()"></div>
  
  <div class="container">
    <div class="header">
      <div class="logo">
        <span>∞</span> InfiCounter
      </div>
      <h1>Mobile Counter</h1>
    </div>
    
    <div class="stats">
      <div class="stat-item">
        <div class="stat-label">Compteur</div>
        <div class="stat-value" id="currentNumber">0</div>
      </div>
      <div class="stat-item">
        <div class="stat-label">Vitesse</div>
        <div class="stat-value" id="speedDisplay">50ms</div>
      </div>
      <div class="stat-item">
        <div class="stat-label">État</div>
        <div class="stat-value" id="statusDisplay">Arrêté</div>
      </div>
    </div>
    
    <div id="output">
      <div class="welcome-message">
        🎉 InfiCounter Mobile<br><br>
        📱 Touchez "Démarrer" pour commencer<br>
        📋 Touchez "Copier" pour sauvegarder<br><br>
        Prêt à compter ? 🚀
      </div>
    </div>
    
    <div class="main-controls">
      <button id="toggleBtn" class="primary-btn" onclick="toggleGenerator()">▶️ Démarrer</button>
      <button onclick="copierTexte()">📋 Copier</button>
    </div>
    
    <div class="secondary-controls">
      <button onclick="changeSpeed()">⚡ Vitesse</button>
      <button onclick="setStartNumber()">🔢 Départ</button>
      <button onclick="resetCounter()">🔄 Reset</button>
    </div>
    
    <div class="utility-controls">
      <button onclick="increaseFontSize()">🔍 A+</button>
      <button onclick="decreaseFontSize()">🔍 A-</button>
    </div>

    <div class="utility-controls">
      <button onclick="toggleContact()">✉️ Contact</button>
      <button onclick="window.open('https://ko-fi.com/Alevax', '_blank')">☕ Soutenir</button>
    </div>

    <div class="bottom-safe-area"></div>
  </div>

  <button class="fab" onclick="toggleMusic()" title="Musique">
    🎶
  </button>

  <button class="theme-selector" onclick="changerBackground()" title="Changer le thème">
    🎨
  </button>

  <div id="contactForm" class="contact-form">
    <h2>Contact</h2>
    <form onsubmit="submitContact(event)">
      <label for="name">Nom</label>
      <input type="text" id="name" name="name" placeholder="Votre nom" required>
      
      <label for="email">Email</label>
      <input type="email" id="email" name="email" placeholder="votre@email.com" required>
      
      <label for="message">Message</label>
      <textarea id="message" name="message" rows="3" placeholder="Votre message..." required></textarea>
      
      <div class="form-buttons">
        <button type="submit">✨ Envoyer</button>
        <button type="button" class="cancel-btn" onclick="closeModal()">❌ Annuler</button>
      </div>
    </form>
  </div>

  <script>
    // Variables globales
    let i = 0;
    let running = false;
    let interval;
    let speed = 50;
    let fontSize = 14;
    let currentBg = 0;
    let totalGenerated = 0;

    // Éléments DOM
    const output = document.getElementById('output');
    const toggleBtn = document.getElementById('toggleBtn');
    const contactForm = document.getElementById('contactForm');
    const modalOverlay = document.getElementById('modalOverlay');
    const currentNumberDisplay = document.getElementById('currentNumber');
    const speedDisplay = document.getElementById('speedDisplay');
    const statusDisplay = document.getElementById('statusDisplay');

    // Thèmes
    const backgrounds = [
      { bg: "linear-gradient(135deg, #1a1a2e 0%, #16213e 25%, #0f3460 50%, #533a71 75%, #6b4c57 100%)", name: "Perplexity" },
      { bg: "linear-gradient(135deg, #0c0c0c 0%, #1a1a1a 25%, #2d2d30 50%, #1e1e1e 75%, #000000 100%)", name: "Midnight" },
      { bg: "linear-gradient(135deg, #2d1b69 0%, #11998e 25%, #38ef7d 50%, #667eea 75%, #764ba2 100%)", name: "Aurora" },
      { bg: "linear-gradient(135deg, #1e3c72 0%, #2a5298 25%, #667eea 50%, #764ba2 75%, #f093fb 100%)", name: "Ocean" },
      { bg: "linear-gradient(135deg, #4b6cb7 0%, #182848 25%, #2d1b69 50%, #0f0c29 75%, #24243e 100%)", name: "Deep Space" }
    ];

    // Fonctions principales
    function generate() {
      if (output.querySelector('.welcome-message')) {
        output.innerHTML = '';
      }
      output.textContent += i + '\n';
      currentNumberDisplay.textContent = i;
      i++;
      totalGenerated++;
      output.scrollTop = output.scrollHeight;
    }

    function toggleGenerator() {
      if (running) {
        clearInterval(interval);
        running = false;
        toggleBtn.innerHTML = '▶️ Démarrer';
        toggleBtn.classList.add('primary-btn');
        statusDisplay.textContent = 'Arrêté';
        navigator.vibrate && navigator.vibrate(50);
      } else {
        interval = setInterval(generate, speed);
        running = true;
        toggleBtn.innerHTML = '⏸️ Arrêter <span class="running-indicator"></span>';
        toggleBtn.classList.remove('primary-btn');
        statusDisplay.textContent = 'En cours';
        navigator.vibrate && navigator.vibrate(100);
      }
    }

    function copierTexte() {
      const texte = output.textContent;
      if (texte.trim() === '' || output.querySelector('.welcome-message')) {
        showNotification("❌ Aucun chiffre à copier !");
        navigator.vibrate && navigator.vibrate([100, 50, 100]);
        return;
      }
      
      navigator.clipboard.writeText(texte).then(() => {
        showNotification("✅ Chiffres copiés !");
        navigator.vibrate && navigator.vibrate(200);
      }).catch(err => {
        showNotification("❌ Erreur lors de la copie");
        navigator.vibrate && navigator.vibrate([100, 50, 100, 50, 100]);
      });
    }

    function changeSpeed() {
      const newSpeed = prompt("Nouvelle vitesse (ms):\n\n50 = Rapide\n100 = Moyen\n200 = Lent", speed);
      const parsedSpeed = parseInt(newSpeed);
      
      if (isNaN(parsedSpeed) || parsedSpeed <= 0) {
        showNotification("⚠️ Nombre invalide");
        return;
      }
      
      speed = parsedSpeed;
      speedDisplay.textContent = speed + "ms";
      
      if (running) {
        clearInterval(interval);
        interval = setInterval(generate, speed);
      }
      
      showNotification(`✅ Vitesse: ${speed}ms`);
      navigator.vibrate && navigator.vibrate(50);
    }

    function setStartNumber() {
      const startNumber = prompt("Chiffre de départ:", i);
      const parsedNumber = parseInt(startNumber);
      
      if (isNaN(parsedNumber)) {
        showNotification("⚠️ Nombre invalide");
        return;
      }
      
      i = parsedNumber;
      currentNumberDisplay.textContent = i;
      output.innerHTML = '';
      showNotification(`✅ Départ: ${i}`);
      navigator.vibrate && navigator.vibrate(50);
    }

    function resetCounter() {
      if (running) {
        clearInterval(interval);
        running = false;
        toggleBtn.innerHTML = '▶️ Démarrer';
        toggleBtn.classList.add('primary-btn');
        statusDisplay.textContent = 'Arrêté';
      }
      
      i = 0;
      totalGenerated = 0;
      currentNumberDisplay.textContent = 0;
      output.innerHTML = '<div class="welcome-message">🔄 Compteur remis à zéro<br><br>Prêt pour un nouveau départ ! 🚀</div>';
      showNotification("✅ Compteur remis à zéro");
      navigator.vibrate && navigator.vibrate(100);
    }

    function increaseFontSize() {
      fontSize = Math.min(20, fontSize + 1);
      output.style.fontSize = fontSize + 'px';
      showNotification(`🔍 Taille: ${fontSize}px`);
    }

    function decreaseFontSize() {
      fontSize = Math.max(10, fontSize - 1);
      output.style.fontSize = fontSize + 'px';
      showNotification(`🔍 Taille: ${fontSize}px`);
    }

    function changerBackground() {
      currentBg = (currentBg + 1) % backgrounds.length;
      const theme = backgrounds[currentBg];
      
      document.body.style.background = theme.bg;
      showNotification(`🎨 ${theme.name}`);
      navigator.vibrate && navigator.vibrate(30);
    }

    function toggleContact() {
      contactForm.style.display = 'block';
      modalOverlay.style.display = 'block';
      document.body.style.overflow = 'hidden';
    }

    function closeModal() {
      contactForm.style.display = 'none';
      modalOverlay.style.display = 'none';
      document.body.style.overflow = 'auto';
    }

    function submitContact(event) {
      event.preventDefault();
      const name = document.getElementById('name').value;
      const email = document.getElementById('email').value;
      
      showNotification(`✅ Message de ${name} envoyé !`);
      
      // Reset
      document.getElementById('name').value = '';
      document.getElementById('email').value = '';
      document.getElementById('message').value = '';
      
      closeModal();
      navigator.vibrate && navigator.vibrate(200);
    }

    function toggleMusic() {
      try {
        const audioContext = new (window.AudioContext || window.webkitAudioContext)();
        const oscillator = audioContext.createOscillator();
        const gainNode = audioContext.createGain();
        
        oscillator.connect(gainNode);
        gainNode.connect(audioContext.destination);
        
        oscillator.frequency.setValueAtTime(523, audioContext.currentTime); // Note C5
        gainNode.gain.setValueAtTime(0.03, audioContext.currentTime);
        
        oscillator.start();
        oscillator.stop(audioContext.currentTime + 0.2);
        
        showNotification("🎶 Son activé !");
        navigator.vibrate && navigator.vibrate(50);
      } catch (error) {
        showNotification("❌ Audio non disponible");
      }
    }

    function showNotification(message) {
      // Supprimer notification existante
      const existing = document.querySelector('.notification');
      if (existing) existing.remove();
      
      const notification = document.createElement('div');
      notification.className = 'notification';
      notification.textContent = message;
      
      document.body.appendChild(notification);
      
      // Animation d'entrée
      setTimeout(() => {
        notification.style.transform = 'translateY(0)';
      }, 100);
      
      // Suppression
      setTimeout(() => {
        notification.style.transform = 'translateY(-120px)';
        setTimeout(() => {
          if (notification.parentNode) {
            notification.parentNode.removeChild(notification);
          }
        }, 300);
      }, 3000);
    }

    // Initialisation
    output.style.fontSize = fontSize + 'px';
    
    // Gestion du swipe pour fermer les modales
    let touchStartY = 0;
    contactForm.addEventListener('touchstart', (e) => {
      touchStartY = e.touches[0].clientY;
    });

    contactForm.addEventListener('touchend', (e) => {
      const touchEndY = e.changedTouches[0].clientY;
      const diff = touchStartY - touchEndY;
      
      if (Math.abs(diff) > 100 && diff > 0) {
        // Swipe up pour fermer
        closeModal();
      }
    });

    // Empêcher le zoom sur double tap
    let lastTouchEnd = 0;
    document.addEventListener('touchend', (e) => {
      const now = (new Date()).getTime();
      if (now - lastTouchEnd <= 300) {
        e.preventDefault();
      }
      lastTouchEnd = now;
    }, false);

    // Gestion de l'orientation
    window.addEventListener('orientationchange', () => {
      setTimeout(() => {
        output.style.height = window.innerHeight < 600 ? '35vh' : '45vh';
      }, 500);
    });

    // Service worker pour PWA (optionnel)
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('data:text/javascript,').catch(() => {});
    }
  </script>
</body>
</html>
